// ============================================================
// ЛАБОРАТОРНАЯ РАБОТА №1
// Гистограммы и плотности распределений
// ============================================================

#import "@preview/numbly:0.1.0": numbly

// ============================================================
// НАСТРОЙКИ ДОКУМЕНТА
// ============================================================

#set page(
  paper: "a4",
  margin: (left: 3cm, right: 2cm, top: 2.5cm, bottom: 2.5cm),
  numbering: "1",
)

#set text(
  size: 14pt,
  lang: "ru",
)

#set heading(
  numbering: "1.",
)

#set par(
  justify: true,
  first-line-indent: 1.25cm,
)

// ============================================================
// ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ
// ============================================================

#let figure-caption(pos: bottom, supplement: "Рисунок") = {
  block(
    width: 100%,
    text(size: 12pt, [#supplement #counter(figure) — #body])
  )
}

#let table-caption(pos: top, supplement: "Таблица") = {
  block(
    width: 100%,
    text(size: 12pt, [#supplement #counter(table) — #body])
  )
}

// ============================================================
// ТИТУЛЬНЫЙ ЛИСТ
// ============================================================

#set page(numbering: none)


#v(1cm)

#block(
  width: 100%,
  text(size: 14pt, weight: "bold", [
     #align(center)[Санкт-Петербургский Политехнический университет имени Петра Великого]
  ])
)

#v(1cm)

#block(
  width: 100%,
  text(size: 14pt, [
     #align(center)[Кафедра прикладной математики и информатики]
  ])
)

#v(3cm)

#block(
  width: 100%,
  text(size: 18pt, weight: "bold", [
     #align(center)[ОТЧЁТ]
  ])
)

#v(0.5cm)


#block(
  width: 100%,
  text(size: 16pt, weight: "bold", [
    #align(center)[
      *по лабораторной работе №1*
    ]
  ])
)

#v(1cm)

#align(center)[
    *ГИСТОГРАММЫ И ПЛОТНОСТИ РАСПРЕДЕЛЕНИЙ*
  ]

#v(2cm)

#block(
  width: 100%,
  inset: (left: 8cm),
  [
    Выполнил:\
    студент группы 5030102/30003 \
    Крутянский Роман Игоревич
  ]
)

#v(0.5cm)

#block(
  width: 100%,
  inset: (left: 8cm),
  [
    Преподаватель: Баженов Александр Николаевич
  ]
)

#v(5cm)

#align(center)[
  Санкт-Петербург\
  2025
]

// ============================================================
// ОСНОВНАЯ ЧАСТЬ
// ============================================================

#pagebreak()
#set page(numbering: "1")

= Постановка задачи

Целью данной лабораторной работы является освоение основных методов визуализации распределений случайных величин с помощью гистограмм, а также исследование влияния размера выборки на точность восстановления теоретической плотности распределения.

#enum(
  [Сгенерировать выборки объёмом $n = 10, 100, 1000$ для каждого из пяти распределений:],
  [Построить гистограммы выборок с наложением теоретических кривых плотности,],
  [Проанализировать влияние количества интервалов (бинов) на качество визуализации,],
  [Сделать выводы о сходимости эмпирического распределения к теоретическому при росте $n$.],
)

Исследуются следующие распределения:

#table(
  columns: 4,
  inset: 8pt,
  stroke: (bottom: 0.5pt),
  [№], [Распределение], [Обозначение], [Параметры],
  [1], [Нормальное], [$N(x; 0, 1)$], [$mu = 0, sigma = 1$],
  [2], [Коши], [$C(x; 0, 1)$], [$x_0 = 0, gamma = 1$],
  [3], [Лапласа], [$L(x; 0, 1/sqrt(2))$], [$mu = 0, b = 1/sqrt(2)$],
  [4], [Пуассона], [$P(k; 10)$], [$lambda = 10$],
  [5], [Равномерное], [$U(x; -sqrt(3), sqrt(3))$], [$a = -sqrt(3), b = sqrt(3)$],
)

= Теоретическая часть

== Гистограмма

Гистограмма — это графическое представление распределения количественных данных, где диапазон значений разбивается на интервалы (бины), и для каждого интервала отображается частота попадания значений выборки в этот интервал.

Пусть имеется выборка $x_1, x_2, ..., x_n$ объёма $n$. Диапазон значений $[x_(min), x_(max)]$ разбивается на $k$ интервалов шириной $h$:

$ h = (x_(max) - x_(min)) / k $

Частота попадания в $i$-й интервал:

$ n_i = {j: x_j in [a_i, a_(i+1))} $

Нормированная гистограмма (оценка плотности):

$ hat(f)(x) = n_i / (n * h), quad x in [a_i, a_(i+1)) $ 

= Реализация

== Инструментарий

Работа выполнена на языке программирования `Python 3.10` с использованием следующих библиотек:

#table(
  columns: 2,
  inset: 8pt,
  [Библиотека], [Назначение],
  [`numpy`], [Генерация выборок, численные расчёты],
  [`matplotlib`], [Построение графиков и гистограмм],
  [`scipy.stats`], [Теоретические распределения и их функции],
)

== Алгоритм работы

Программа реализует следующий алгоритм:

#enum(
  [Для каждого из 5 распределений генерируются 3 выборки объёмом $n = 10, 100, 1000$],
  [Для каждой выборки строится нормированная гистограмма с автоматическим выбором количества бинов],
  [На тот же график наносится теоретическая кривая плотности распределения],
  [Все графики сохраняются в картинку в формате `png`],
)

= Результаты

== Визуализация распределений

На рисунках @fig:normal-hist–@fig:uniform-hist представлены гистограммы для всех исследуемых распределений при различных объёмах выборки.

#figure(
  image("../../results/lab1/Normal_histograms.png", width: 100%),
  caption: [Гистограммы нормального распределения $N(0, 1)$ при $n = 10, 100, 1000$],
) <fig:normal-hist>

#figure(
  image("../../results/lab1/Cauchy_histograms.png", width: 100%),
  caption: [Гистограммы распределения Коши $C(0, 1)$ при $n = 10, 100, 1000$],
) <fig:cauchy-hist>

#figure(
  image("../../results/lab1/Laplace_histograms.png", width: 100%),
  caption: [Гистограммы распределения Лапласа $L(0, 1/sqrt(2))$ при $n = 10, 100, 1000$],
) <fig:laplace-hist>

#figure(
  image("../../results/lab1/Poisson_histograms.png", width: 100%),
  caption: [Гистограммы распределения Пуассона $P(10)$ при $n = 10, 100, 1000$],
) <fig:poisson-hist>

#figure(
  image("../../results/lab1/Uniform_histograms.png", width: 100%),
  caption: [Гистограммы равномерного распределения $U(-sqrt(3), sqrt(3))$ при $n = 10, 100, 1000$],
) <fig:uniform-hist>

== Сводный график

На рисунке @fig:all-hist представлены все распределения на одном графике для сравнения.

#figure(
  image("../../results/lab1/all_histograms.png", width: 100%),
  caption: [Сравнение гистограмм всех распределений при $n = 10,100,1000$],
) <fig:all-hist>

= Обсуждение

== Влияние размера выборки

Анализ полученных результатов позволяет сделать следующие наблюдения:

#table(
  columns: 2,
  inset: 8pt,
  [Размер выборки], [Характеристики гистограммы],
  [$n = 10$], [Сильный шум, форма распределения неочевидна, большие отклонения от теоретической кривой],
  [$n = 100$], [Появляется узнаваемая форма, но сохраняются заметные флуктуации],
  [$n = 1000$], [Хорошее соответствие теоретической плотности, гладкая форма гистограммы],
)

== Особенности распределений

*Нормальное распределение.* При $n >= 100$ гистограмма хорошо аппроксимирует колоколообразную кривую. Симметрия относительно $x = 0$ становится очевидной.

*Распределение Коши.* Характеризуется тяжёлыми хвостами, что приводит к появлению выбросов даже при больших $n$. Гистограмма имеет более широкое основание по сравнению с нормальным распределением.

*Распределение Лапласа.* Отличается более острым пиком в центре ($x = 0$) и экспоненциальным убыванием хвостов.

*Распределение Пуассона.* Дискретная природа распределения хорошо видна на гистограмме. При $lambda = 10$ распределение приближается к нормальному (центральная предельная теорема).

*Равномерное распределение.* Гистограмма стремится к прямоугольной форме. При малых $n$ наблюдаются значительные отклонения от равномерности.

== Проблема выбора бинов

Экспериментально подтверждено, что:

- Слишком малое количество бинов приводит к потере информации о форме распределения
- Слишком большое количество бинов создаёт «шумный» график с пустыми интервалами
- Автоматический выбор (`bins='auto'` в matplotlib) даёт разумный компромисс для большинства случаев

= Выводы

В ходе выполнения лабораторной работы были достигнуты следующие результаты:

#enum(
  [Освоен принцип группировки данных и построения нормированных гистограмм],
  [Продемонстрирована сходимость эмпирического распределения к теоретическому при росте объёма выборки],
  [Получены навыки работы с непрерывными и дискретными распределениями в Python],
)

Наиболее существенное влияние размера выборки наблюдается для распределений с тяжёлыми хвостами (Коши) и дискретных распределений (Пуассона).
